BootStrap: yum
OSVersion: 7
MirrorURL: http://mirror.centos.org/centos-%{OSVERSION}/%{OSVERSION}/os/$basearch/
Include: yum
%setup

%files

%environment 

%runscript
exec /octave-5.1.0/run-octave "$@"

%post
    # commands to be executed inside container during bootstrap
    # add python and install some packages
    yum -y update
    yum -y groups install "Development Tools"
    yum -y groups install "GNOME Desktop"
    yum -y groups install "Base"
    yum -y groups install "X Window System" "Desktop" "Fonts"
    yum -y install qt
    yum -y install mesa-libGLU
    yum -y install SDL SDL-devel
    yum install -y epel-release
#    yum -y update
    yum -y install qtwebkit
    yum -y install qt5-qtbase-devel   
    yum -y install yum-utils
    yum-builddep -y octave
    yum -y install qt-devel mercurial gcc-c++ lapack-devel libtool
    yum -y install epstool transfig pstoedit qscintilla-devel
    yum -y install librsvg2-tools icoutils bzip2-devel libsndfile-devel
    yum -y install portaudio-devel mesa-libOSMesa-devel 
    yum -y install sundials-devel sundials-threads-devel
    yum -y install gnulib-devel
    yum -y install arpack-devel arpack2-dev libarpack2-dev
    export JAVA_HOME=/usr/lib/jvm/java
    
    
    wget ftp://ftp.gnu.org/gnu/octave/octave-5.1.0.tar.xz 
    tar xf octave-5.1.0.tar.xz 
    rm octave-5.1.0.tar.xz 
    cd octave-5.1.0/ 
    ./configure --with-qt=4 --with-arpack-libdir=/usr/lib64/
    make -j6 all
    make check
    make install
    
    mkdir -p /storage/home
    mkdir -p /storage/work
    mkdir -p /gpfs/scratch
    mkdir -p /gpfs/group
    mkdir -p /var/spool/torque
    mkdir -p /usr/bin/nvidia-smi
